

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Welcome to pygobnilp’s documentation! &mdash; pygobnilp  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> pygobnilp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to pygobnilp’s documentation!</a><ul>
<li><a class="reference internal" href="#the-gobnilp-class">The Gobnilp class</a></li>
<li><a class="reference internal" href="#the-bn-class">The BN class</a></li>
<li><a class="reference internal" href="#the-mn-class">The MN class</a></li>
<li><a class="reference internal" href="#the-data-class">The Data class</a></li>
<li><a class="reference internal" href="#the-discretedata-class">The DiscreteData class</a></li>
<li><a class="reference internal" href="#the-absdiscretellscore-class">The AbsDiscreteLLScore class</a></li>
<li><a class="reference internal" href="#the-discretell-class">The DiscreteLL class</a></li>
<li><a class="reference internal" href="#the-discretebic-class">The DiscreteBIC class</a></li>
<li><a class="reference internal" href="#the-discreteaic-class">The DiscreteAIC class</a></li>
<li><a class="reference internal" href="#the-bdeu-class">The BDeu class</a></li>
<li><a class="reference internal" href="#the-continuousdata-class">The ContinuousData class</a></li>
<li><a class="reference internal" href="#the-absgaussianllscore-class">The AbsGaussianLLScore class</a></li>
<li><a class="reference internal" href="#the-gaussianll-class">The GaussianLL class</a></li>
<li><a class="reference internal" href="#the-gaussianbic-class">The GaussianBIC class</a></li>
<li><a class="reference internal" href="#the-gaussianaic-class">The GaussianAIC class</a></li>
<li><a class="reference internal" href="#the-gaussianl0-class">The GaussianL0 class</a></li>
<li><a class="reference internal" href="#the-bge-class">The BGe class</a></li>
<li><a class="reference internal" href="#the-mixeddata-class">The MixedData class</a></li>
<li><a class="reference internal" href="#the-abscgaussianllscore-class">The AbsCGaussianLLScore class</a></li>
<li><a class="reference internal" href="#the-cgaussianll-class">The CGaussianLL class</a></li>
<li><a class="reference internal" href="#the-cgaussianbic-class">The CGaussianBIC class</a></li>
<li><a class="reference internal" href="#the-cgaussianaic-class">The CGaussianAIC class</a></li>
<li><a class="reference internal" href="#module-pygobnilp.gobnilp">Functions in the gobnilp module</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pygobnilp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Welcome to pygobnilp’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-pygobnilp-s-documentation">
<h1>Welcome to pygobnilp’s documentation!<a class="headerlink" href="#welcome-to-pygobnilp-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="the-gobnilp-class">
<h2>The Gobnilp class<a class="headerlink" href="#the-gobnilp-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">Gobnilp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of <a class="reference external" href="https://www.gurobi.com/documentation/9.0/refman/py_model.html">the Gurobi Model class test test test test</a> specific
to learning Bayesian networks.
See documentation for <a class="reference external" href="https://www.gurobi.com/documentation/9.0/refman/py_model.html">the Gurobi Model class</a>
for all methods not documented here.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.StageError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-name descname"><span class="pre">StageError</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a method is called at the wrong stage of learning.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.UserConstraintError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-name descname"><span class="pre">UserConstraintError</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when there is a problem with a user-defined constraint.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise a Gobnilp object</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.absolute_generation_difference">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">absolute_generation_difference</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.absolute_generation_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of absolute generation difference variables
(if these variables have been created, by default they are not)</p>
<p>Assuming the appropriate constraints have been added,
if it exists <code class="docutils literal notranslate"><span class="pre">absolute_generation_difference[v1,v2]</span></code> is the absolute value of
<code class="docutils literal notranslate"><span class="pre">generation_difference[v1,v2]</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no absolute generation difference variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_basic_constraints">
<span class="sig-name descname"><span class="pre">add_basic_constraints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_basic_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the most useful constraints</p>
<p>Adds the constraints added by the following methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_oneparentset" title="pygobnilp.gobnilp.Gobnilp.add_constraints_oneparentset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_oneparentset</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_setpacking" title="pygobnilp.gobnilp.Gobnilp.add_constraints_setpacking"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_setpacking</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family" title="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_arrow_family</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_arrow_adjacency</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_clusters" title="pygobnilp.gobnilp.Gobnilp.add_constraints_clusters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_clusters</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_basic_variables">
<span class="sig-name descname"><span class="pre">add_basic_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_basic_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the most useful Gurobi MIP variables</p>
<p>Adds the variables added by the following methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_family" title="pygobnilp.gobnilp.Gobnilp.add_variables_family"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_family</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_arrow" title="pygobnilp.gobnilp.Gobnilp.add_variables_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_arrow</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_variables_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_adjacency</span></code></a></p></li>
</ul>
<p>Arrow and adjacency variables are given a higher branching priority than family
variables to encourage a balanced search tree.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_4b">
<span class="sig-name descname"><span class="pre">add_constraints_4b</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_4b" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds “4B” constraints.</p>
<p>All possibly useful 4B constraints are created but these are stored
as lazy constraints with a lazy setting of 3 which means that a 4B constraint is pulled into the MIP model only
when they cut off the current linear relaxation solution (or integer solution).</p>
<p>See
<a class="reference external" href="https://jair.org/index.php/jair/article/view/11041/26213">Bayesian Network Structure Learning with Integer Programming:
Polytopes, Facets and Complexity (Cussens et al, JAIR)</a>
for details</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_absgendiff">
<span class="sig-name descname"><span class="pre">add_constraints_absgendiff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_absgendiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints linking generation difference variables to
absolute generation difference variables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency">
<span class="sig-name descname"><span class="pre">add_constraints_arrow_adjacency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Add constraints that there is an adjacency between
v1 and v2 in the undirected skeleton if there is either an
arrow from v1 to v2, or an arrow from v2 to v1 in the DAG</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family">
<span class="sig-name descname"><span class="pre">add_constraints_arrow_family</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints linking arrow variables to family variables</p>
<p>If <code class="docutils literal notranslate"><span class="pre">pa</span></code> is not a parent of <code class="docutils literal notranslate"><span class="pre">ch</span></code> in any family then the corresponding
arrow variable <code class="docutils literal notranslate"><span class="pre">ch&lt;-pa</span></code> is simply removed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_total_order">
<span class="sig-name descname"><span class="pre">add_constraints_arrow_total_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_total_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints linking arrow variables to total order variables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_bests">
<span class="sig-name descname"><span class="pre">add_constraints_bests</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_bests" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the constraint that at least one BN variable has its best scoring parent
set selected</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_choose_best_for_order">
<span class="sig-name descname"><span class="pre">add_constraints_choose_best_for_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_choose_best_for_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint that the highest scoring parent set
should be chosen whenever whenever the total order variables
indicate that doing so would not cause a cycle</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_chordal">
<span class="sig-name descname"><span class="pre">add_constraints_chordal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_chordal" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds simple constraints to rule out non-chordal DAGs
i.e. those without v-structures (aka immoralities)</p>
<dl class="simple">
<dt>Constraints are roughly of this sort:</dt><dd><p>a&lt;-{b,c} + b&lt;-{a,c} + c&lt;-{a,b} &lt;= a-b</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_clusters">
<span class="sig-name descname"><span class="pre">add_constraints_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matroid_cuts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matroid_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds cluster constraints</p>
<p>For any cluster of BN variable, the cluster constraint states that at least one element
in the cluster has no parents in that cluster.</p>
<p>These constraints are always added lazily, since there are exponentially many of them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_cuts</strong> (<em>bool</em>) – If True then cluster constraints are added as cuts (i.e. as soon as the linear
relaxation is solved). If False, we wait until a candidate integer solution is found.</p></li>
<li><p><strong>matroid_cuts</strong> (<em>bool</em>) – If True then cuts corresponding to rank 2 matroids are also added.</p></li>
<li><p><strong>matroid_constraints</strong> (<em>bool</em>) – If True then constraints corresponding to rank 2 matroids are added
when an integer solution corresponding to a cyclic digraph is generated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_cycles">
<span class="sig-name descname"><span class="pre">add_constraints_cycles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds cycle constraints (on arrow variables)</p>
<p>Since there are exponentially many possible cycles, these constraints are added lazily
(via a callback).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator">
<span class="sig-name descname"><span class="pre">add_constraints_gen_arrow_indicator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints stating that an arrow from parent to child
means that the child’s generation number is strictly greater than the parent’s.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_gen_index_link">
<span class="sig-name descname"><span class="pre">add_constraints_gen_index_link</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gen_index_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint linking generation to generation index variables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff">
<span class="sig-name descname"><span class="pre">add_constraints_gendiff</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints linking generation difference variables to generation variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_genindex">
<span class="sig-name descname"><span class="pre">add_constraints_genindex</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_genindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint that each variable has exactly one
generation index and that each of these indices is distinct</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_kbranching">
<span class="sig-name descname"><span class="pre">add_constraints_kbranching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_kbranching" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a constraint so that the learned BN is a k-branching.</p>
<p>A DAG is a branching if each child has at most one parent.
A DAG is a k-branching if there is a set of at most k edges
the removal of which results in a branching</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>k</strong> (<em>int</em>) – The value of k</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_one_dag_per_MEC">
<span class="sig-name descname"><span class="pre">add_constraints_one_dag_per_MEC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">careful</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_one_dag_per_MEC" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a constraint that only one DAG per Markov equivalence class is feasible.</p>
<p>The constraint is effected by adding appropriate lazy constraints when Gurobi
generates a DAG solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamic</strong> (<em>bool</em>) – If True then which DAG is feasible for each Markov equivalence
class is arbitrary (it will be the first one Gurobi comes across). If false
then the representative DAG is fixed
(and is determined by the method <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.mec2dag" title="pygobnilp.gobnilp.Gobnilp.mec2dag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dec2mag</span></code></a>).</p></li>
<li><p><strong>careful</strong> (<em>bool</em>) – If True then all the lazy constraints are stored (not just posted)
to ensure that new solutions satisfy them. (The value for <cite>careful</cite> is ignored if
<cite>dynamic</cite> is False.)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_oneparentset">
<span class="sig-name descname"><span class="pre">add_constraints_oneparentset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_oneparentset" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint that each child has exactly one parent set.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_polytree">
<span class="sig-name descname"><span class="pre">add_constraints_polytree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_polytree" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint that the DAG should be a polytree</p>
<p>Constraints (and cuts) ruling out cycles in the undirected skeletong are always added lazily,
since there are exponentially many of them.</p>
<p>Cluster constraints are removed if this constraint added since ruling out cycles
in the undirected skeleton prevents any in the DAG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_setpacking">
<span class="sig-name descname"><span class="pre">add_constraints_setpacking</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_setpacking" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints like a&lt;-b,c + b&lt;-a,c + c&lt;-a,b &lt;= 1.
That is an example for a “triple”. Also adds similar constraints for 4-tuples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_sumgen">
<span class="sig-name descname"><span class="pre">add_constraints_sumgen</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_sumgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the constraint that sum of generation numbers is n*(n-1)/2</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_constraints_total_order">
<span class="sig-name descname"><span class="pre">add_constraints_total_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lazy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_total_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds constraints so that total order variables
represent a total order</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lazy</strong> (<em>int</em>) – Controls the ‘laziness’ of these constraints by settng the
Lazy attribute of the constraints.
See <a class="reference external" href="https://www.gurobi.com/documentation/9.0/refman/lazy.html">the Gurobi documentation</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency">
<span class="sig-name descname"><span class="pre">add_forbidden_adjacency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that a pair of vertices must not be adjacent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uv</strong> (<em>iter</em>) – Pair of nodes</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the adjacency is also obligatory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor">
<span class="sig-name descname"><span class="pre">add_forbidden_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add constraint that there can be no directed path from <cite>u</cite> to <cite>v</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>str</em>) – Start of path</p></li>
<li><p><strong>v</strong> (<em>str</em>) – End of path</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the vertices are the same or the directed path is also obligatory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow">
<span class="sig-name descname"><span class="pre">add_forbidden_arrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that there can be no arrow between two vertices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>str</em>) – Head of forbidden arrow</p></li>
<li><p><strong>v</strong> (<em>str</em>) – Tail of forbidden arrow</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the vertices are the same or the arrow is also obligatory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency">
<span class="sig-name descname"><span class="pre">add_obligatory_adjacency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that a pair of vertices must be adjacent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uv</strong> (<em>iter</em>) – Pair of nodes</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the adjacency is also forbidden.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor">
<span class="sig-name descname"><span class="pre">add_obligatory_ancestor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that there must be a directed path between specified vertices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>str</em>) – Start of path</p></li>
<li><p><strong>v</strong> (<em>str</em>) – End of path</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the vertices are the same or the directed path is also forbidden or would create a cycle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow">
<span class="sig-name descname"><span class="pre">add_obligatory_arrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Add constraint that there must be an arrow from <cite>u</cite> to <cite>v</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>str</em>) – Head of arrow</p></li>
<li><p><strong>v</strong> (<em>str</em>) – Tail of arrow</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the vertices are the same or the arrow is also forbidden or would create a cycle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence">
<span class="sig-name descname"><span class="pre">add_obligatory_conditional_independence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that each BN variable in <cite>a</cite> must be independent of each BN variable in <cite>b</cite> conditional on <cite>s</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>iter</em>) – A set of BN variables</p></li>
<li><p><strong>b</strong> (<em>iter</em>) – A set of BN variables</p></li>
<li><p><strong>s</strong> (<em>iter</em>) – A set, possibly empty, of BN variables</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If <cite>a</cite> or <cite>b</cite> is empty or the 3 sets are not
    disjoint or the desired conditional independence is not possible
    (given other constraints).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_obligatory_independence">
<span class="sig-name descname"><span class="pre">add_obligatory_independence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_independence" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint that each BN variable in <cite>a</cite> must be independent of each BN variable in <cite>b</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>iter</em>) – A set of BN variables</p></li>
<li><p><strong>b</strong> (<em>iter</em>) – A set of BN variables</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.UserConstraintError" title="pygobnilp.gobnilp.Gobnilp.UserConstraintError"><strong>Gobnilp.UserConstraintError</strong></a> – If the 3 sets are not disjoint or the desired conditional independence is not possible
    (given other constraints).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_absgendiff">
<span class="sig-name descname"><span class="pre">add_variables_absgendiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_absgendiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds variables representing the absolute difference in generation number
between each pair of distinct BN variables.</p>
<p>These variables are constrained to have a <strong>lower bound of 1</strong>. So as long as
constraints are posted connecting these variables to the <em>generation_difference</em> variables
and thus ultimately to the <em>generation</em> variables, then each BN variable will have
a different generation number.</p>
<p>Calling <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_absgendiff" title="pygobnilp.gobnilp.Gobnilp.add_constraints_absgendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_absgendiff</span></code></a> ensure that
these variables indeed are equal to the absolute values of generation difference variables.</p>
<p>Generation variables are added with <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gen" title="pygobnilp.gobnilp.Gobnilp.add_variables_gen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gen</span></code></a>.
Generation difference variables are added with <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_variables_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gendiff</span></code></a>.
See the documentation for these two methods for details of how to add appropriate constraints.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
absolute generation difference variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_adjacency">
<span class="sig-name descname"><span class="pre">add_variables_adjacency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds binary Gurobi MIP adjacency variables to the model</p>
<p>The adjacency variable corresponding to <code class="docutils literal notranslate"><span class="pre">{v1,v2}</span></code> is set to 1 iff
there is an arrow from <code class="docutils literal notranslate"><span class="pre">v1</span></code> to <code class="docutils literal notranslate"><span class="pre">v2</span></code> or an arrow from <code class="docutils literal notranslate"><span class="pre">v2</span></code> to <code class="docutils literal notranslate"><span class="pre">v1</span></code>.</p>
<p>To connect these variables appropriately to arrow variables it is necessary to
call <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_arrow_adjacency</span></code></a>.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
adjacency variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_arrow">
<span class="sig-name descname"><span class="pre">add_variables_arrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_arrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds binary Gurobi MIP arrow variables to the model</p>
<p>The arrow variable corresponding to <code class="docutils literal notranslate"><span class="pre">(pa,ch)</span></code> is set to 1 iff
there is an arrow from <code class="docutils literal notranslate"><span class="pre">pa</span></code> to <code class="docutils literal notranslate"><span class="pre">ch</span></code> in a learned BN.</p>
<p>To connect these variables appropriately to family variables it is necessary to
call <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family" title="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_family"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_arrow_family</span></code></a>.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
arrow variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_family">
<span class="sig-name descname"><span class="pre">add_variables_family</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_first_branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds binary Gurobi MIP family variables to the model</p>
<p>This method should only be called after data (or local scores) have been read
in using, for example, a method such as
<code class="xref py py-meth docutils literal notranslate"><span class="pre">input_discrete_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
family variables. This value is ignored if <cite>best_first_branch_priority</cite> is True.</p></li>
<li><p><strong>best_first_branch_priority</strong> (<em>bool</em>) – If True then the branching priority for the
family variables for any given child are (totally) ordered according to local score,
with the higher scoring families given higher branching priority than lower ones.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_gen">
<span class="sig-name descname"><span class="pre">add_variables_gen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds generation variables to the model</p>
<p>A generation number for a variable in a DAG is an integer such that any variable
has a generation number stricty greater than any of its parents.</p>
<p>To connect these variables appropriately to arrow variables it is necessary to
call <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gen_arrow_indicator</span></code></a>.</p>
<p>To set the sum of all generation numbers to n*(n-1)/2 use
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_sumgen" title="pygobnilp.gobnilp.Gobnilp.add_constraints_sumgen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_sumgen</span></code></a>.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
generation variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_gendiff">
<span class="sig-name descname"><span class="pre">add_variables_gendiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gendiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds variables representing the difference in generation number
between distinct BN variables</p>
<p>Generation and generation difference variables are connected appropriately with
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gendiff</span></code></a>.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
generation difference variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_genindex">
<span class="sig-name descname"><span class="pre">add_variables_genindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">earlyfirst</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_genindex" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds binary variables indicating whether a BN variable has a particular generation number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
generation index variables. (Ignored if <cite>earlyfirst==True</cite>.)</p></li>
<li><p><strong>earlyfirst</strong> (<em>bool</em>) – Generation index variable for low generation numbers have higher
branching priority than those for high generation numbers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_kbranching">
<span class="sig-name descname"><span class="pre">add_variables_kbranching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_kbranching" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a variable which is the number of arcs that must
be deleted for the learned DAG to be a <em>branching</em>. In a branching
each node has at most one parent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
generation difference variables.</p></li>
<li><p><strong>ub</strong> (<em>int</em>) – An upper bound for this variable</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_kbranching_ch">
<span class="sig-name descname"><span class="pre">add_variables_kbranching_ch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_kbranching_ch" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds variables for recording max(0,|parents|-1) for each child</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
generation difference variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.add_variables_total_order">
<span class="sig-name descname"><span class="pre">add_variables_total_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.add_variables_total_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds binary Gurobi MIP total order variables to the model</p>
<p>The total order variable corresponding to <code class="docutils literal notranslate"><span class="pre">(v1,v2)</span></code> is set to 1 iff
<code class="docutils literal notranslate"><span class="pre">v1</span> <span class="pre">&gt;</span> <span class="pre">v2</span></code> in the total order associated with a learned BN. Parents always come
before children in the total order.</p>
<p>To connect these variables appropriately to arrow variables it is necessary to
call <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_total_order" title="pygobnilp.gobnilp.Gobnilp.add_constraints_arrow_total_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_arrow_total_order</span></code></a>.</p>
<p>All these variables are given objective value 0. (This can be overridden using the <code class="docutils literal notranslate"><span class="pre">Obj</span></code> attribute
of the variable.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>branch_priority</strong> (<em>int</em>) – The Gurobi branching priority for the
total order variables.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.adjacency">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">adjacency</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of adjacency variables
(if these variables have been created, by default they are)</p>
<p>Assuming the appropriate constraints have been added,
<code class="docutils literal notranslate"><span class="pre">adjacency[{v1,v2}]</span></code> is the adjacency variable indicating that <code class="docutils literal notranslate"><span class="pre">v1</span></code> and <code class="docutils literal notranslate"><span class="pre">v2</span></code> are adjacent.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no adjacency variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.allowed_user_constypes">
<span class="sig-name descname"><span class="pre">allowed_user_constypes</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('forbidden_arrows',</span> <span class="pre">'forbidden_adjacencies',</span> <span class="pre">'obligatory_arrows',</span> <span class="pre">'obligatory_adjacencies',</span> <span class="pre">'obligatory_ancestors',</span> <span class="pre">'forbidden_ancestors',</span> <span class="pre">'obligatory_conditional_independences')</span></em><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.allowed_user_constypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Constraint types available to users. Used as key values
when providing constraints via a dictionary. For each constraint type
there is also a method for adding constraints whose name has add_ as a prefix
and is in the singular.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict" title="pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">input_user_conss_from_dict</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_arrow</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_adjacency</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_arrow</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_adjacency</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_ancestor</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_ancestor</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_conditional_independence</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.arrow">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">arrow</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.arrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of arrow variables
(if these variables have been created, by default they are)</p>
<p>Assuming the appropriate constraints have been added,
<code class="docutils literal notranslate"><span class="pre">arrow[pa,ch]</span></code> is the arrow variable indicating that there is an arrow from <code class="docutils literal notranslate"><span class="pre">pa</span></code>
to <code class="docutils literal notranslate"><span class="pre">ch</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no arrow variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.before">
<span class="sig-name descname"><span class="pre">before</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.before" title="Permalink to this definition">¶</a></dt>
<dd><p>Is stage1 strictly after stage2?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage1</strong> (<em>str</em>) – A Gobnilp learning stage</p></li>
<li><p><strong>stage2</strong> (<em>str</em>) – A Gobnilp learning stage</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>KeyError</strong> – If any of the arguments are not the names of Gobnilp learning stages</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether <cite>stage1</cite> is strictly before <cite>stage2</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.between">
<span class="sig-name descname"><span class="pre">between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.between" title="Permalink to this definition">¶</a></dt>
<dd><p>Is stage2 strictly after stage1 but not strictly after stage 3?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage1</strong> (<em>str</em>) – A Gobnilp learning stage</p></li>
<li><p><strong>stage2</strong> (<em>str</em>) – A Gobnilp learning stage</p></li>
<li><p><strong>stage3</strong> (<em>str</em>) – A Gobnilp learning stage</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>KeyError</strong> – If any of the arguments are not the names of Gobnilp learning stages</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether <cite>stage2</cite> is strictly after <cite>stage1</cite> but not strictly after <cite>stage3</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.bn_variables">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bn_variables</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.bn_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>The BN variables (in order)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.bn_variables_index">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bn_variables_index</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.bn_variables_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps each BN variable to its index in the sorted list of BN variables</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.child">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">child</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.child" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">child[i]</span></code> is the child in the family with index <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.get_family_index" title="pygobnilp.gobnilp.Gobnilp.get_family_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_family_index</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.parents" title="pygobnilp.gobnilp.Gobnilp.parents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parents</span></code></a> and
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.family_list" title="pygobnilp.gobnilp.Gobnilp.family_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">family_list</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.clear_basic_model">
<span class="sig-name descname"><span class="pre">clear_basic_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.clear_basic_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes variables and constraints added by
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.make_basic_model" title="pygobnilp.gobnilp.Gobnilp.make_basic_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_basic_model</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.dag2mec">
<span class="sig-name descname"><span class="pre">dag2mec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.dag2mec" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the Markov equivalence class for a DAG</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dag</strong> (<em>iterable</em>) – A DAG represented by a collection of
(indices for) ‘families’, where each family is a BN variable
together with its parents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A set of sets which is a sparse representation of the characteristic imset
which represents the Markov equivalence class.
If (and only if) a set has value 1 in the characteristic imset then it is included as an element in the returned set.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>frozenset</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Note that the BN variable, its parents and the binary MIP
variable for a family can be recovered from its index using the methods
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.child" title="pygobnilp.gobnilp.Gobnilp.child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.parents" title="pygobnilp.gobnilp.Gobnilp.parents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parents</span></code></a> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">family_variable</span></code>,
respectively.</p>
<p>A rough ‘inverse’ of this method is <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.mec2dag" title="pygobnilp.gobnilp.Gobnilp.mec2dag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mec2dag</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.data">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Data associated with the instance</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.data_arities">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">data_arities</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.data_arities" title="Permalink to this definition">¶</a></dt>
<dd><p>Arities of the variables in the data</p>
<p>The order of the arities matches the order of the variables
in the data, see: <cite>data_variables</cite> not the order in <cite>bn_variables</cite>
(which is always in sorted order).</p>
<p>Raises AttributeError if continuous data being used</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.data_variables">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">data_variables</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.data_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>the variables in the data</p>
<p>Variables are in the order supplied by the original data source
not the order in <cite>bn_variables</cite>
(which is always in sorted order).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.family">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">family</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.family" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of family variables
(if these variables have been created, by default they are)</p>
<p>Assuming the appropriate constraints have been added,
<code class="docutils literal notranslate"><span class="pre">family[child][parent_set]</span></code> is the family variable indicating that <code class="docutils literal notranslate"><span class="pre">parent_set</span></code> is the
parent set for <code class="docutils literal notranslate"><span class="pre">child</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no family variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.family_list">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">family_list</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.family_list" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">family_list[i]</span></code> is the family variable for the family with index <code class="docutils literal notranslate"><span class="pre">i</span></code>.
(if these variables have been created, by default they are)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.get_family_index" title="pygobnilp.gobnilp.Gobnilp.get_family_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_family_index</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.child" title="pygobnilp.gobnilp.Gobnilp.child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.parents" title="pygobnilp.gobnilp.Gobnilp.parents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parents</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no family variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.family_scores">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">family_scores</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.family_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of family scores (aka local scores)</p>
<p><code class="docutils literal notranslate"><span class="pre">family_scores[child][parentset]</span></code> is the local score for <code class="docutils literal notranslate"><span class="pre">child</span></code> having
<code class="docutils literal notranslate"><span class="pre">parentset</span></code> (a frozenset) as its parents.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no local scores have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.forbidden_adjacencies">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">forbidden_adjacencies</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.forbidden_adjacencies" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>{u,v}</cite> is included then an adjacency between <cite>u</cite> to <cite>v</cite> is forbidden.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_adjacency</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.forbidden_ancestors">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">forbidden_ancestors</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.forbidden_ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>(u,v)</cite> is included then an directed path from <cite>u</cite> to <cite>v</cite> is forbidden.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_ancestors</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.forbidden_arrows">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">forbidden_arrows</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.forbidden_arrows" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>(u,v)</cite> is included then an arrow from <cite>u</cite> to <cite>v</cite> is forbidden.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_arrow</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.generation">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">generation</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.generation" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of generation variables
(if these variables have been created by calling
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gen" title="pygobnilp.gobnilp.Gobnilp.add_variables_gen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gen</span></code></a>)</p>
<p>Assuming appropriate constraints have been added, by,
for example, calling the method
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gen_arrow_indicator</span></code></a>,
then <code class="docutils literal notranslate"><span class="pre">generation[v1]</span></code> is the generation number for <code class="docutils literal notranslate"><span class="pre">v1</span></code>.</p>
<p>See Section 3.1.2 of <a class="reference external" href="https://www.cs.york.ac.uk/ftpdir/pub/aig/Papers/james.cussens/wcb10.pdf">Maximum likelihood pedigree reconstruction using integer
programming (Cussens, 2010)</a>
for details of how generation variables can be used to rule out cycles in directed graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no generation variables have been created</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gen" title="pygobnilp.gobnilp.Gobnilp.add_variables_gen"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gen</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gen_arrow_indicator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gen_arrow_indicator</span></code></a></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.generation_difference">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">generation_difference</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.generation_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of generation difference variables
(if these variables have been created by calling
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_variables_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gendiff</span></code></a>)</p>
<p>Assuming the appropriate constraints have been added, by, for example,
calling the method
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gendiff</span></code></a>,
then <code class="docutils literal notranslate"><span class="pre">generation_difference[v1,v2]</span> <span class="pre">=</span> <span class="pre">generation[v1]</span> <span class="pre">-</span> <span class="pre">generation[v2]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no generation difference variables have been created</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_variables_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_gendiff</span></code></a></p></li>
<li><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff" title="pygobnilp.gobnilp.Gobnilp.add_constraints_gendiff"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_constraints_gendiff</span></code></a></p></li>
</ul>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.generation_index">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">generation_index</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.generation_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of generation index variables
(if these variables have been created, by default they are not)</p>
<p>Assuming the appropriate constraints have been added,
if it exists <code class="docutils literal notranslate"><span class="pre">generation_index[v1,pos]</span></code> indicates whether <code class="docutils literal notranslate"><span class="pre">v1</span></code> has generation number <code class="docutils literal notranslate"><span class="pre">pos</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no generation index variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.get_family_index">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">get_family_index</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.get_family_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps a family to its index</p>
<p><code class="docutils literal notranslate"><span class="pre">get_family_index[child][parents]</span></code> is the index for the given family.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.child" title="pygobnilp.gobnilp.Gobnilp.child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child</span></code></a> and
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.parents" title="pygobnilp.gobnilp.Gobnilp.parents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parents</span></code></a> and
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.family_list" title="pygobnilp.gobnilp.Gobnilp.family_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">family_list</span></code></a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.gobnilp_optimize">
<span class="sig-name descname"><span class="pre">gobnilp_optimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.gobnilp_optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the MIP model constructed by Gobnilp</p>
<p>This overrides Gurobi’s optimize method by hard coding in calls to
a callback function for adding Gobnilp specific lazy constraints (and cuts).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.input_local_scores">
<span class="sig-name descname"><span class="pre">input_local_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_scores</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.input_local_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Read local scores from a dictionary.</p>
<p>Once this method has been run, methods for adding MIP variables, such as
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_variables_family" title="pygobnilp.gobnilp.Gobnilp.add_variables_family"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_variables_family</span></code></a> and
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_basic_variables" title="pygobnilp.gobnilp.Gobnilp.add_basic_variables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_basic_variables</span></code></a>, can be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>local_scores</strong> (<em>dict</em>) – Dictionary containing local scores.
<code class="docutils literal notranslate"><span class="pre">local_scores[child][parentset]</span></code> is the score for <code class="docutils literal notranslate"><span class="pre">child</span></code> having parents <code class="docutils literal notranslate"><span class="pre">parentset</span></code>
where <code class="docutils literal notranslate"><span class="pre">parentset</span></code> is a frozenset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.input_user_conss">
<span class="sig-name descname"><span class="pre">input_user_conss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.input_user_conss" title="Permalink to this definition">¶</a></dt>
<dd><p>Read user constraints from a Python module and store them</p>
<p>If <cite>consfile</cite> is None then this method returns silently.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.allowed_user_constypes" title="pygobnilp.gobnilp.Gobnilp.allowed_user_constypes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_use_constypes</span></code></a></p>
</div>
<p>Such constraints can be read in prior to computation of local
scores, and can make that computation more efficient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>consfile</strong> (<em>str/None</em>) – If not None then a file containing user constraints</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict">
<span class="sig-name descname"><span class="pre">input_user_conss_from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consdict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Read user constraints from a dictionary and store them</p>
<p>The keys of the dictionary must be strings each of which should name an
allowed constraint type.
Each value should be either (1) a sequence of items where each item is a sequence
(perhaps of length one) providing argument(s) to give to the corresponding “add_..”
method. For example, dkt1 (below) would be an acceptable dictionary (assuming A, B, C, E and F) are
BN variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dkt1</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;forbidden_adjacencies&#39;</span><span class="p">:[[</span><span class="s1">&#39;AB&#39;</span><span class="p">],[</span><span class="s1">&#39;BC&#39;</span><span class="p">]],</span>
<span class="s1">&#39;obligatory_arrows&#39;</span><span class="p">:[[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">]]}</span>
</pre></div>
</div>
<p>or (2) a function which, when given the Gobnilp object, returns a sequence of the same form as in case 1). For example, dkt2 would
be an acceptable dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">no_arrows</span><span class="p">(</span><span class="n">gobnilp</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">([(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">gobnilp</span><span class="o">.</span><span class="n">bn_variables</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">gobnilp</span><span class="o">.</span><span class="n">bn_variables</span> <span class="k">if</span> <span class="n">w</span><span class="o">!=</span><span class="n">v</span><span class="p">])</span>
<span class="n">dkt2</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;forbidden_arrows&#39;</span><span class="p">:</span><span class="n">no_arrows</span><span class="p">}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.allowed_user_constypes" title="pygobnilp.gobnilp.Gobnilp.allowed_user_constypes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_use_constypes</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_arrow</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_adjacency</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_arrow</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_adjacency</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_ancestor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_ancestor</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor" title="pygobnilp.gobnilp.Gobnilp.add_forbidden_ancestor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_forbidden_ancestor</span></code></a>
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_conditional_independence</span></code></a></p>
</div>
<p>Such constraints can be read in prior to computation of local
scores, and can make that computation more efficient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>consdict</strong> (<em>dict/None</em>) – Dictionary mapping the names of allowed constraint types
to constraints</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If dictionary contains a key that is not (the name of) an allowed constraint type</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'no</span> <span class="pre">data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output</span> <span class="pre">written'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'discrete'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BDeu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_score_fun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_scores_source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polytree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chordal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consdict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settingsfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_penalty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abbrev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_stem</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_cpdag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('pdf')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gurobi_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.learn" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_source</strong> (<em>str/array_like</em>) – If not None, name of the file containing the discrete data or an array_like object.
If None, then it is assumed that  data has previously been read in.</p></li>
<li><p><strong>varnames</strong> (<em>iterable/None</em>) – Names for the variables in the data. If <cite>data_source</cite> is a filename then
this value is ignored and the variable names are those given in the file.
Otherwise if None then the variable names will X1, X2, …</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Ignored if <cite>data</cite> is not a filename with continuous data.
Whether a header containing variable names is the first non-comment line in the file.</p></li>
<li><p><strong>comments</strong> (<em>str</em>) – Ignored if <cite>data</cite> is not a filename with continuous data. Lines starting with this string are treated as comments.</p></li>
<li><p><strong>delimiter</strong> (<em>None/str</em>) – Ignored if <cite>data</cite> is not a filename with continuous data.
String used to separate values. If None then whitespace is used.</p></li>
<li><p><strong>start</strong> (<em>str</em>) – Starting stage for learning. Possible stages are: ‘no data’, ‘data’, ‘local scores’,
‘MIP model’, ‘MIP solution’, ‘BN(s)’ and ‘CPDAG(s)’.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – End stage for learning. Possible values are the same as for <cite>start</cite>.</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – Indicates the type of data. Must be either ‘discrete’, ‘continuous’, or ‘mixed’.</p></li>
<li><p><strong>score</strong> (<em>str</em>) – Name of scoring function used for computing local scores. Must be one of the following:
BDeu, BGe,
DiscreteLL, DiscreteBIC, DiscreteAIC,
GaussianLL, GaussianBIC, GaussianAIC, GaussianL0
CGaussianLL, CGaussianBIC, CGaussianAIC. This value is ignored if <cite>local_score_fun</cite> is not None.</p></li>
<li><p><strong>local_score_fun</strong> (<em>fun/None</em>) – If not None a local score function such that <cite>local_score_fun(child,parents)</cite>
computes <cite>(score,ub)</cite> where <cite>score</cite> is the desired local score for <cite>child</cite> having parentset <cite>parents</cite>
and <cite>ub</cite> is either <cite>None</cite> or an upper bound on the local score for <cite>child</cite> with any proper superset of <cite>parents</cite></p></li>
<li><p><strong>k</strong> (<em>float</em>) – Penalty multiplier for penalised log-likelihood scores (eg BIC, AIC) or tuning parameter (‘lambda^2) for l_0
penalised Gaussian scoring (as per van de Geer and Buehlmann)</p></li>
<li><p><strong>standardise</strong> (<em>bool</em>) – Whether to standardise continuous data.</p></li>
<li><p><strong>arities</strong> (<em>array_like/None</em>) – Arities for the discrete variables. If <cite>data_source</cite> is a filename then
this value is ignored and the arities are those given in the file.
Otherwise if None then the arity for a variable is set to the number of distinct
values observed for that variable in the data. Ignored for continuous data.</p></li>
<li><p><strong>palim</strong> (<em>int/None</em>) – If an integer, this should be the maximum size of parent sets.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The equivalent sample size for BDeu local score generation.</p></li>
<li><p><strong>nu</strong> (<em>iter/None</em>) – The mean vector for the Normal part of the normal-Wishart prior for BGe scoring.
If None then the sample mean is used.</p></li>
<li><p><strong>alpha_mu</strong> (<em>float</em>) – Imaginary sample size value for the Normal part of the normal-Wishart prior for BGe scoring.</p></li>
<li><p><strong>alpha_omega</strong> (<em>float/None</em>) – Degrees of freedom for the Wishart part of the normal-Wishart prior for BGe scoring.
Must be at least the number of variables. If None then set to 2 more than the number of variables.</p></li>
<li><p><strong>starts</strong> (<em>iter</em>) – A sequence of feasible DAGs the highest scoring one of which will be the initial
incumbent solution. Each element in the sequence can be either a bnlearn model string or an nx.DiGraph instance.
If this value is not empty, a local scoring function must be provided.</p></li>
<li><p><strong>local_scores_source</strong> (<em>str/file/dict/None</em>) – Ignored if None. If not None then local scores are not computed from data.
but come from <cite>local_scores_source</cite>. If a string then the name of a file containing local scores.
If a file then the file containing local scores.
If a dictionary, then <code class="docutils literal notranslate"><span class="pre">local_scores[child][parentset]</span></code> is the score for <code class="docutils literal notranslate"><span class="pre">child</span></code> having parents <code class="docutils literal notranslate"><span class="pre">parentset</span></code>
where <code class="docutils literal notranslate"><span class="pre">parentset</span></code> is a frozenset.</p></li>
<li><p><strong>nsols</strong> (<em>int</em>) – Number of BNs to learn</p></li>
<li><p><strong>kbest</strong> (<em>bool</em>) – Whether the <cite>nsols</cite> learned BNs should be a highest scoring set of <cite>nsols</cite> BNs.</p></li>
<li><p><strong>mec</strong> (<em>bool</em>) – Whether only one BN per Markov equivalence class should be feasible.</p></li>
<li><p><strong>polytree</strong> (<em>bool</em>) – Whether the BN must be a polytree.</p></li>
<li><p><strong>chordal</strong> (<em>bool</em>) – Whether the BN represent a chordal undirected graph (i.e. have no immoralities).</p></li>
<li><p><strong>consfile</strong> (<em>str/None</em>) – If not None then a file (Python module) containing user constraints.
Each such constraint is stored indefinitely and it is not possible to remove them.</p></li>
<li><p><strong>consdict</strong> (<em>dict/None</em>) – If not None then a dictionary containing user constraints.
The dictionary is used as input to <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict" title="pygobnilp.gobnilp.Gobnilp.input_user_conss_from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">input_user_conss_from_dict</span></code></a></p></li>
<li><p><strong>settingsfile</strong> (<em>str/None</em>) – If not None then a file (Python module) containing values for the arguments for this method.
Any such values override both default values and any values set by the method caller.</p></li>
<li><p><strong>pruning</strong> (<em>bool</em>) – Whether not to include parent sets which cannot be optimal when acyclicity is the only constraint.</p></li>
<li><p><strong>edge_penalty</strong> (<em>float</em>) – The local score for a parent set with <cite>p</cite> parents will be reduced by <cite>p*edge_penalty</cite>.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Whether to plot learned BNs/CPDAGs once they have been learned.</p></li>
<li><p><strong>abbrev</strong> (<em>bool</em>) – When plotting whether to abbreviate variable names to the first 3 characters.</p></li>
<li><p><strong>output_scores</strong> (<em>str/file/None</em>) – If not None, then a file or name of a file to write local scores</p></li>
<li><p><strong>output_stem</strong> (<em>str/None</em>) – If not None, then learned BNs will be written to “output_stem.ext” for each extension defined in
<cite>output_ext</cite>. If multiple DAGs have been learned then output files are called “output_stem_0.ext”,
“output_stem_1.ext” …</p></li>
<li><p><strong>output_dag</strong> (<em>bool</em>) – Whether to write DAGs to any output files</p></li>
<li><p><strong>output_cpdag</strong> (<em>bool</em>) – Whether to write CPDAGs to any output files</p></li>
<li><p><strong>output_ext</strong> (<em>tuple</em>) – File extensions.</p></li>
<li><p><strong>verbose</strong> (<em>int</em>) – How much information to show when adding variables and constraints (and computing scores)</p></li>
<li><p><strong>gurobi_output</strong> (<em>bool</em>) – Whether to show output generated by Gurobi.</p></li>
<li><p><strong>**params</strong> – Arbitrary Gurobi model parameter settings. For example if this method is called with TimeLimit=3, then
the Gurobi model parameter TimeLimit will be set to 3</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>start= ‘no data’</cite> but no data source or local scores source has been provided</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.learned_bn">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">learned_bn</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.learned_bn" title="Permalink to this definition">¶</a></dt>
<dd><p>Learned BN (a maximally scoring one if several learned)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.BN" title="pygobnilp.gobnilp.BN">BN</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.learned_bns">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">learned_bns</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.learned_bns" title="Permalink to this definition">¶</a></dt>
<dd><p>Learned BNs</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.local_scores">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">local_scores</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.local_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>alternative name for family_scores</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.make_basic_model">
<span class="sig-name descname"><span class="pre">make_basic_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polytree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chordal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.make_basic_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds standard variables and constraints to the model, together with any user constraints</p>
<p>Variables added by <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_basic_variables" title="pygobnilp.gobnilp.Gobnilp.add_basic_variables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_basic_variables</span></code></a>.
Constraints added by <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_basic_constraints" title="pygobnilp.gobnilp.Gobnilp.add_basic_constraints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_basic_constraints</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsols</strong> (<em>int</em>) – Number of BNs to learn</p></li>
<li><p><strong>kbest</strong> (<em>bool</em>) – Whether the <cite>nsols</cite> learned BNs should be a highest scoring set of <cite>nsols</cite> BNs.</p></li>
<li><p><strong>mec</strong> (<em>bool</em>) – Whether only one BN per Markov equivalence class should be feasible.</p></li>
<li><p><strong>polytree</strong> (<em>bool</em>) – Whether the BN must be a polytree</p></li>
<li><p><strong>chordal</strong> (<em>bool</em>) – Whether the BN must contain no immoralities</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If local scores are not yet available.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.mec2dag">
<span class="sig-name descname"><span class="pre">mec2dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.mec2dag" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a DAG representative from a Markov equivalence class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>frozenset</em>) – A Markov equivalence class represented by a characteristic imset which is
itself (sparsely) represented by the set of all sets with value 1 in the characteristic imset.
This method assumes that <cite>c</cite> is a valid characteristic imset without any checking.</p></li>
<li><p><strong>vs</strong> (<em>iterable</em>) – An ordering for the BN variables which determines the particular DAG representative
returned. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the ordering determined by Python <code class="docutils literal notranslate"><span class="pre">sort</span></code> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The DAG represented by a list of family indices, or None if the required families are not represented.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list/None</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>A rough ‘inverse’ of this method is <a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.dag2mec" title="pygobnilp.gobnilp.Gobnilp.dag2mec"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dag2mec</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.n">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">n</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of BN variables</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.obligatory_adjacencies">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">obligatory_adjacencies</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.obligatory_adjacencies" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>{u,v}</cite> is included then an adjacency between <cite>u</cite> to <cite>v</cite> is obligatory.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_adjacency"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_adjacency</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.obligatory_ancestors">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">obligatory_ancestors</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.obligatory_ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>(u,v)</cite> is included then an directed path from <cite>u</cite> to <cite>v</cite> is obligatory.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_ancestors</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.obligatory_arrows">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">obligatory_arrows</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.obligatory_arrows" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>(u,v)</cite> is included then an arrow from <cite>u</cite> to <cite>v</cite> is obligatory.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_arrow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_arrow</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.obligatory_conditional_independences">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">obligatory_conditional_independences</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.obligatory_conditional_independences" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>(a,b,s)</cite> is included, where each is a frozenset, then each BN variable in <cite>a</cite> must be independent of each BN variable in <cite>b</cite> conditional on <cite>s</cite>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_conditional_independence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_conditional_independence</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.add_obligatory_independence" title="pygobnilp.gobnilp.Gobnilp.add_obligatory_independence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_obligatory_independence</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.ordered_parentsets">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ordered_parentsets</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.ordered_parentsets" title="Permalink to this definition">¶</a></dt>
<dd><p>For each child a list of parent sets sorted by local score</p>
<p>Higher scoring parent sets come before lower scoring ones. Each parent set
is a frozenset.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no local scores have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.parents">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">parents</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.parents" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">parents[i]</span></code> is the parent set in the family with index <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p>
<p>The parent set is a frozenset.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.get_family_index" title="pygobnilp.gobnilp.Gobnilp.get_family_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_family_index</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.child" title="pygobnilp.gobnilp.Gobnilp.child"><code class="xref py py-meth docutils literal notranslate"><span class="pre">child</span></code></a>,
<a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.family_list" title="pygobnilp.gobnilp.Gobnilp.family_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">family_list</span></code></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.rawdata">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">rawdata</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw data associated with the instance</p>
<p>Returns a two-dimensional array with one row for each datapoint
(and thus one colun for each variable).</p>
<p>If the data is discrete the array entries are of dtype
uint32 and if the data is discrete the entries are of dtype
float64</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.return_local_scores">
<span class="sig-name descname"><span class="pre">return_local_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_score_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.return_local_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary for each child variable where the keys
are the child variables and the values map parent sets to
local scores.</p>
<p>Not all parent sets are included. If <cite>palim</cite> is not None,
then only those parent sets of cardinality at most <cite>palim</cite> can be included.</p>
<p>Also, when <cite>pruning=True</cite>, a parent set is only included if its local score
exceeds that of all its proper subsets.</p>
<p><cite>local_score_fun</cite> should be a function that computes a local
score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_score_fun</strong> (<em>fun/None</em>) – If not None a local score function such that <cite>local_score_fun(child,parents)</cite>
computes <cite>(score,ub)</cite> where <cite>score</cite> is the desired local score for <cite>child</cite> having parentset <cite>parents</cite>
and <cite>ub</cite> is either <cite>None</cite> or an upper bound on the local score for <cite>child</cite> with any proper superset of <cite>parents</cite></p></li>
<li><p><strong>palim</strong> (<em>int/None</em>) – If not None then the maximal size of a parent set</p></li>
<li><p><strong>pruning</strong> (<em>bool</em>) – Whether not to include parent sets which cannot be optimal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary <cite>dkt</cite> such that <cite>dkt[child][parentset]</cite> is the local score for <cite>child</cite> having parent set <cite>parentset</cite> (where <cite>parentset</cite> is a frozenset).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.set_bn_variables">
<span class="sig-name descname"><span class="pre">set_bn_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bnvars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.set_bn_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the BN variables to be a subset of existing BN variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bnvars</strong> (<em>iter</em>) – A subset of the existing BN variables</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>bnvars</cite> is not a subset of the variables in the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.set_stage">
<span class="sig-name descname"><span class="pre">set_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.set_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually set the stage of learning</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stage</strong> (<em>str</em>) – The desired stage of learning</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>stage</cite> is not among the list of possible stages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.set_starts">
<span class="sig-name descname"><span class="pre">set_starts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.set_starts" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a set of ‘starting’ DAGs</p>
<p>The highest scoring of these DAGs will become the initial incumbent in the search for the best DAG.
So the learned DAG will have a score at least as good as the best of these.</p>
<p>This method should be called prior to computing local scores to ensure that the local scores required for
each starting DAG are computed even if parent sets in starting DAGs are bigger than the current limit on parent sets.
(So limits on parent set size do not affect starting DAGs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dags</strong> (<em>iter</em>) – Collection of DAGS. Each individual DAG must be either a bnlearn modelstring or a nx.DiGraph object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.sol2fvs">
<span class="sig-name descname"><span class="pre">sol2fvs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.sol2fvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the family variables set to true by some Gurobi solution</p>
<p>The solution corresponding to the current value of Gurobi parameter <code class="docutils literal notranslate"><span class="pre">SolutionNumber</span></code>
is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A pair of lists. The first list contains the families as <code class="docutils literal notranslate"><span class="pre">(child,parents)</span></code>
tuples, where <code class="docutils literal notranslate"><span class="pre">parents</span></code> is a frozenset. The second list contains Gurobi binary
MIP variables for the families.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.stage">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">stage</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Stage of solving</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.stages">
<span class="sig-name descname"><span class="pre">stages</span></span><em class="property"> <span class="pre">=</span> <span class="pre">('no</span> <span class="pre">data',</span> <span class="pre">'data',</span> <span class="pre">'local</span> <span class="pre">scores',</span> <span class="pre">'MIP</span> <span class="pre">model',</span> <span class="pre">'MIP</span> <span class="pre">solution',</span> <span class="pre">'BN(s)',</span> <span class="pre">'CPDAG(s)',</span> <span class="pre">'output</span> <span class="pre">shown',</span> <span class="pre">'output</span> <span class="pre">written')</span></em><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.stages" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple of strings giving Gobnilp’s stages of learning (in order).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.stages_set">
<span class="sig-name descname"><span class="pre">stages_set</span></span><em class="property"> <span class="pre">=</span> <span class="pre">frozenset({'BN(s)',</span> <span class="pre">'CPDAG(s)',</span> <span class="pre">'MIP</span> <span class="pre">model',</span> <span class="pre">'MIP</span> <span class="pre">solution',</span> <span class="pre">'data',</span> <span class="pre">'local</span> <span class="pre">scores',</span> <span class="pre">'no</span> <span class="pre">data',</span> <span class="pre">'output</span> <span class="pre">shown',</span> <span class="pre">'output</span> <span class="pre">written'})</span></em><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.stages_set" title="Permalink to this definition">¶</a></dt>
<dd><p>The set of Gobnilp’s stages of learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>frozenset</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.total_order">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">total_order</span></span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.total_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of total order variables
(if these variables have been created, by default they are not)</p>
<p>Assuming the appropriate constraints have been added,
if it exists <code class="docutils literal notranslate"><span class="pre">total_order[v1,v2]</span></code> is the total order variable indicating that <code class="docutils literal notranslate"><span class="pre">v1</span> <span class="pre">&gt;</span> <span class="pre">v2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pygobnilp.gobnilp.Gobnilp.StageError" title="pygobnilp.gobnilp.Gobnilp.StageError"><strong>Gobnilp.StageError</strong></a> – If no total order variables have been created</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.Gobnilp.write_local_scores">
<span class="sig-name descname"><span class="pre">write_local_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.Gobnilp.write_local_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Write local scores to a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>str/file</em>) – If a string the name of the file to write to (where “-” leads to writing
to standard output). Otherwise a file object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-bn-class">
<h2>The BN class<a class="headerlink" href="#the-bn-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">BN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/classes/digraph.html">networkx.DiGraph</a>.
See documentation for
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/classes/digraph.html">networkx.DiGraph</a>
for all methods not documented here.</p>
<p>At present this class only implements the structure of a BN - the DAG.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a textual representation of the BN</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A textual representation of the BN</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.adjacency_matrix">
<span class="sig-name descname"><span class="pre">adjacency_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.adjacency_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>The adjacency matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The adjacency matrix</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.bnlearn_modelstring">
<span class="sig-name descname"><span class="pre">bnlearn_modelstring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.bnlearn_modelstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string representation suitable for bnlearn’s “modelstring” function</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string representation of the BN structure (DAG) suitable for bnlearn’s “modelstring” function</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.compute_compelled">
<span class="sig-name descname"><span class="pre">compute_compelled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compelled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.compute_compelled" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines which directed edges are present in all DAGs Markov equivalent
to the given DAG (i.e. which are compelled to have this direction).</p>
<p>Whether an edge has its direction compelled is given by the “compelled” attribute
of the edge.</p>
<p>Starting from a initial set of edges whose direction is <em>compelled</em> to be that
given in the DAG,
the following 3 rules from Koller and Friedman (here shown in Prolog) are used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">R1</span>
<span class="n">compelled</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="p">:</span><span class="o">-</span> <span class="n">edge</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span> <span class="n">compelled</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span> <span class="ow">not</span> <span class="n">edge</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span> <span class="ow">not</span> <span class="n">edge</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="o">.</span>
<span class="o">%</span><span class="n">R2</span>
<span class="n">compelled</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="p">:</span><span class="o">-</span> <span class="n">edge</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span> <span class="n">compelled</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span> <span class="n">compelled</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span><span class="o">.</span>
<span class="o">%</span><span class="n">R3</span>
<span class="n">compelled</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="p">:</span><span class="o">-</span> <span class="n">edge</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span> <span class="n">compelled</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span> <span class="n">compelled</span><span class="p">(</span><span class="n">Y2</span><span class="p">,</span><span class="n">Z</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">edge</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y1</span><span class="p">);</span><span class="n">edge</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span><span class="n">X</span><span class="p">)),</span>  <span class="p">(</span><span class="n">edge</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y2</span><span class="p">);</span><span class="n">edge</span><span class="p">(</span><span class="n">Y2</span><span class="p">,</span><span class="n">X</span><span class="p">))</span><span class="o">.</span>
</pre></div>
</div>
<p>This method uses the “semi-naive evaluation” algorithm for computing
the relevant least Herbrand model, which is the set of all the compelled edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>compelled</strong> (<em>iter</em>) – Edges to set as compelled in addition to those involved in
<em>immoralities</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.connected">
<span class="sig-name descname"><span class="pre">connected</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Are <cite>u</cite> and <cite>v</cite> connected (in either direction)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>str</em>) – A node</p></li>
<li><p><strong>v</strong> (<em>str</em>) – A node</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether <cite>u</cite> and <cite>v</cite> are connected</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.cpdag_str">
<span class="sig-name descname"><span class="pre">cpdag_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.cpdag_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a textual representation of the CPDAG</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A textual representation of the CPDAG</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.directed_arrow_colour">
<span class="sig-name descname"><span class="pre">directed_arrow_colour</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'red'</span></em><a class="headerlink" href="#pygobnilp.gobnilp.BN.directed_arrow_colour" title="Permalink to this definition">¶</a></dt>
<dd><p>Colour to indicate a directed arrow</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.directed_arrow_text">
<span class="sig-name descname"><span class="pre">directed_arrow_text</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'-&gt;'</span></em><a class="headerlink" href="#pygobnilp.gobnilp.BN.directed_arrow_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Text to indicate a directed arrow</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.minimal_ancestral_graph">
<span class="sig-name descname"><span class="pre">minimal_ancestral_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.minimal_ancestral_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the minimal ancestral graph of self
containing <cite>nodes</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nodes</strong> (<em>iter</em>) – The nodes for the minimal ancestral graph</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The minimal ancestral graph</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>network.DiGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">abbrev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate and show a plot of the CPDAG/DAG</p>
<p>A DAG from the Markov equivalence class defined by the CPDAG is shown.
Reversible and irreversible arrows are distinguished by colour. By default
the colours are black and red, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>abbrev</strong> (<em>int</em>) – Whether to abbreviate variable names to first 3 characters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.satisfy_ci">
<span class="sig-name descname"><span class="pre">satisfy_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.BN.satisfy_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the DAG satisfy this conditional independence relation:
<cite>a</cite> is independent of <cite>b</cite> conditional on <cite>s</cite>?</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>iter</em>) – A set of BN variables</p></li>
<li><p><strong>b</strong> (<em>iter</em>) – A set of BN variables</p></li>
<li><p><strong>s</strong> (<em>iter</em>) – A set, possibly empty, of BN variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pair where the first element is a bool stating whether
the given conditional independence relation is satisfied and the second
is the minimal ancestral graph containing <cite>a</cite>, <cite>b</cite> and <cite>s</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.undirected_arrow_colour">
<span class="sig-name descname"><span class="pre">undirected_arrow_colour</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'black'</span></em><a class="headerlink" href="#pygobnilp.gobnilp.BN.undirected_arrow_colour" title="Permalink to this definition">¶</a></dt>
<dd><p>Colour to indicate a undirected edge</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.BN.undirected_arrow_text">
<span class="sig-name descname"><span class="pre">undirected_arrow_text</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'-'</span></em><a class="headerlink" href="#pygobnilp.gobnilp.BN.undirected_arrow_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Text to indicate a undirected edge</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-mn-class">
<h2>The MN class<a class="headerlink" href="#the-mn-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.MN">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">MN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.MN" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass of
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/classes/graph.html">networkx.Graph</a>.
See documentation for
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/classes/graph.html">networkx.Graph</a>
for all methods not documented here.</p>
<p>At present this class only implements the structure of a Markov network - an undirected graph</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.MN.satisfy_ci">
<span class="sig-name descname"><span class="pre">satisfy_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.MN.satisfy_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Does the Markov network satisfy <cite>a</cite> _|_ <cite>b</cite> | <cite>s</cite>?
i.e. is there a path from a node in <cite>a</cite> to a node in
<cite>b</cite> which avoids nodes in <cite>s</cite>?</p>
<p>This method does not check that <cite>a</cite>, <cite>b</cite> and <cite>s</cite> are disjoint
or that <cite>a</cite> and <cite>b</cite> are non-empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>iter</em>) – A set of nodes in a Markov network</p></li>
<li><p><strong>b</strong> (<em>iter</em>) – A set of nodes in a Markov network</p></li>
<li><p><strong>s</strong> (<em>iter</em>) – A set of nodes in a Markov network</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the Markov network satisfies <cite>a</cite> _|_ <cite>b</cite> | <cite>s</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-data-class">
<h2>The Data class<a class="headerlink" href="#the-data-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.Data">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">Data</span></span><a class="headerlink" href="#pygobnilp.scoring.Data" title="Permalink to this definition">¶</a></dt>
<dd><p>Complete data (either discrete or continuous)</p>
<p>This is an abstract class</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.Data.rawdata">
<span class="sig-name descname"><span class="pre">rawdata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.Data.rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>The data without any information about variable names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.Data.variables">
<span class="sig-name descname"><span class="pre">variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.Data.variables" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The variable names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.Data.varidx">
<span class="sig-name descname"><span class="pre">varidx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.Data.varidx" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Maps a variable name to its position in the list of variable names.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-discretedata-class">
<h2>The DiscreteData class<a class="headerlink" href="#the-discretedata-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">DiscreteData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.Data" title="pygobnilp.scoring.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.Data</span></code></a></p>
<p>Complete discrete data</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises a <cite>DiscreteData</cite> object.</p>
<p>If  <cite>data_source</cite> is a filename then it is assumed that:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All values are separated by whitespace</p></li>
<li><p>Comment lines start with a ‘#’</p></li>
<li><p>The first line is a header line stating the names of the
variables</p></li>
<li><p>The second line states the arities of the variables</p></li>
<li><p>All other lines contain the actual data</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_source</strong> (<em>str/array_like/Pandas.DataFrame</em>) – Either a filename containing the data or an array_like object or
Pandas data frame containing it.</p></li>
<li><p><strong>varnames</strong> (<em>iter</em>) – Variable names corresponding to columns in the data.
Ignored if <cite>data_source</cite> is a filename or Pandas DataFrame (since they
will supply the variable names). Otherwise if not supplied (<cite>=None</cite>)
then variables names will be: X1, X2, …</p></li>
<li><p><strong>arities</strong> (<em>iter</em>) – Arities for the variables corresponding to columns in the data.
Ignored if <cite>data_source</cite> is a filename or Pandas DataFrame (since they
will supply the arities). Otherwise if not supplied (<cite>=None</cite>)
the arity for each variable will be set to the number of distinct values
observed for that variable in the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.arities">
<span class="sig-name descname"><span class="pre">arities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.arities" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The arities of the variables.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.arity">
<span class="sig-name descname"><span class="pre">arity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.arity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<em>str</em>) – A variable name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The arity of <cite>v</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The data with all values converted to unsigned integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.data_length">
<span class="sig-name descname"><span class="pre">data_length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.data_length" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of datapoints in the data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteData.make_contab_adtree">
<span class="sig-name descname"><span class="pre">make_contab_adtree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteData.make_contab_adtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a marginal contingency table from data or report
that the desired contingency table would be too big.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>iter</em>) – The variables in the marginal contingency table.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>1st element is of type ndarray:</dt><dd><p>If the contingency table would have too many then the array is empty
(and the 2nd element of the tuple should be ignored)
else an array of counts of length equal to the product of the <cite>arities</cite>.
Counts are in lexicographic order of the joint instantiations of the columns (=variables)
2nd element: the ‘strides’ for each column (=variable)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-absdiscretellscore-class">
<h2>The AbsDiscreteLLScore class<a class="headerlink" href="#the-absdiscretellscore-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsDiscreteLLScore">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">AbsDiscreteLLScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsDiscreteLLScore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.DiscreteData</span></code></a></p>
<p>Abstract class for discrete log likelihood scores</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsDiscreteLLScore.entropy">
<span class="sig-name descname"><span class="pre">entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsDiscreteLLScore.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the entropy for the empirical distribution of some variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>iter</em>) – Variables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The entropy for the empirical distribution of <cite>variables</cite> and the number of joint
instantiations of <cite>variables</cite> if not too big else None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsDiscreteLLScore.ll_score">
<span class="sig-name descname"><span class="pre">ll_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsDiscreteLLScore.ll_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The fitted log-likelihood score for <cite>child</cite> having <cite>parents</cite></p>
<p>In addition to the score the number of joint instantations of the parents is returned.
If this number would cause an overflow <cite>None</cite> is returned instead of the number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>The fitted log-likelihood local score for the given family and</p></li>
<li><p>the number of joint instantations of the parents (or None if too big)</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsDiscreteLLScore.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsDiscreteLLScore.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return LL score minus complexity penalty for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets.</p>
<p>To compute the penalty the number of joint instantations is multiplied by the arity
of the child minus one. This value is then multiplied by log(N)/2 for BIC and 1 for AIC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the number of joint instantations of the parents would cause an overflow
    when computing the penalty</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-discretell-class">
<h2>The DiscreteLL class<a class="headerlink" href="#the-discretell-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteLL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">DiscreteLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsDiscreteLLScore" title="pygobnilp.scoring.AbsDiscreteLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsDiscreteLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteLL.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteLL.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises a <cite>DiscreteLL</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><em>DiscreteData</em></a>) – data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteLL.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteLL.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted log-likelihood score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The fitted log-likelihood local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-discretebic-class">
<h2>The DiscreteBIC class<a class="headerlink" href="#the-discretebic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteBIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">DiscreteBIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteBIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsDiscreteLLScore" title="pygobnilp.scoring.AbsDiscreteLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsDiscreteLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteBIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteBIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises a <cite>DiscreteBIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><em>DiscreteData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard BIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-discreteaic-class">
<h2>The DiscreteAIC class<a class="headerlink" href="#the-discreteaic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteAIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">DiscreteAIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteAIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsDiscreteLLScore" title="pygobnilp.scoring.AbsDiscreteLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsDiscreteLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.DiscreteAIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.DiscreteAIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>DiscreteAIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><em>DiscreteData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard AIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-bdeu-class">
<h2>The BDeu class<a class="headerlink" href="#the-bdeu-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">BDeu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.DiscreteData</span></code></a></p>
<p>Discrete data with attributes and methods for BDeu scoring</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises a <cite>BDeu</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.DiscreteData" title="pygobnilp.scoring.DiscreteData"><em>DiscreteData</em></a>) – data</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The <em>equivalent sample size</em></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.alpha">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#pygobnilp.scoring.BDeu.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>The <em>equivalent sample size</em> used for BDeu scoring</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.bdeu_score_component">
<span class="sig-name descname"><span class="pre">bdeu_score_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu.bdeu_score_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the BDeu score component for a set of variables
(from the current dataset).</p>
<p>The BDeu score for a child v having parents Pa is
the BDeu score component for Pa subtracted from that for v+Pa</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>iter</em>) – The names of the variables</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The effective sample size parameter for the BDeu score.
If not supplied (=None)
then the value of <cite>self.alpha</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The BDeu score component.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.bdeu_scores">
<span class="sig-name descname"><span class="pre">bdeu_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">palim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu.bdeu_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Exhaustively compute all BDeu scores for all child variables and all parent sets up to size <cite>palim</cite>.
If <cite>pruning</cite> delete those parent sets which have a subset with a better score.
Return a dictionary dkt where dkt[child][parents] = bdeu_score</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>palim</strong> (<em>int/None</em>) – Limit on parent set size</p></li>
<li><p><strong>pruning</strong> (<em>bool</em>) – Whether to prune</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – ESS for BDeu score.
If not supplied (=None)
then the value of <cite>self.alpha</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dkt where dkt[child][parents] = bdeu_score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.clear_cache">
<span class="sig-name descname"><span class="pre">clear_cache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu.clear_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Empty the cache of stored BDeu component scores</p>
<p>This should be called, for example, if new scores are being computed
with a different alpha value</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BDeu.upper_bound_james">
<span class="sig-name descname"><span class="pre">upper_bound_james</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BDeu.upper_bound_james" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute an upper bound on proper supersets of parents</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – Child variable.</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – Parent variables</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – ESS value for BDeu score. If not supplied (=None)
then the value of <cite>self.alpha</cite> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An upper bound on the local score for parent sets
for <cite>child</cite> which are proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-continuousdata-class">
<h2>The ContinuousData class<a class="headerlink" href="#the-continuousdata-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.ContinuousData">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">ContinuousData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.ContinuousData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.Data" title="pygobnilp.scoring.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.Data</span></code></a></p>
<p>Complete continuous data</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.ContinuousData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.ContinuousData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuous data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray/str</em>) – The data (either as an array or a filename containing the data)</p></li>
<li><p><strong>varnames</strong> (<em>iterable/None</em>) – The names of the variables. If not given
(=None) then if  <cite>data</cite> is a file having the variable names as a header then these are used
else the variables are named X1, X2, X3, etc</p></li>
<li><p><strong>header</strong> (<em>bool</em>) – Ignored if <cite>data</cite> is not a filename.
Whether a header containing variable names is the first non-comment line in the file.</p></li>
<li><p><strong>comments</strong> (<em>str</em>) – Ignored if <cite>data</cite> is not a filename. Lines starting with this string are treated as comments.</p></li>
<li><p><strong>delimiter</strong> (<em>None/str</em>) – Ignored if <cite>data</cite> is not a filename. String used to separate values. If None then whitespace is used.</p></li>
<li><p><strong>standardise</strong> (<em>bool</em>) – Whether to standardise the date to have mean 0 and sd = 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.ContinuousData.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.ContinuousData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The data as a Pandas dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-absgaussianllscore-class">
<h2>The AbsGaussianLLScore class<a class="headerlink" href="#the-absgaussianllscore-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsGaussianLLScore">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">AbsGaussianLLScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comments</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsGaussianLLScore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.ContinuousData</span></code></a></p>
<p>Abstract class for Gaussian log-likelihood scoring</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsGaussianLLScore.gaussianll">
<span class="sig-name descname"><span class="pre">gaussianll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsGaussianLLScore.gaussianll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Gaussian log-likelihood of some variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>iter</em>) – Variables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Gaussian log-likelihood of some variables</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsGaussianLLScore.ll_score">
<span class="sig-name descname"><span class="pre">ll_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsGaussianLLScore.ll_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The Gaussian log-likelhood score for a given family, plus a dummy upper bound</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parents</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: the Gaussian log-likelihood score for the family for current data</p></li>
<li><p>int: the number of parameters which is number of parents plus 2 (intercept plus sd of residuals) (int)</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-gaussianll-class">
<h2>The GaussianLL class<a class="headerlink" href="#the-gaussianll-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianLL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">GaussianLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsGaussianLLScore" title="pygobnilp.scoring.AbsGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianLL.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianLL.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>GaussianLL</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianLL.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianLL.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted log-likelihood score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The fitted log-likelihood local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianLL.score_dag">
<span class="sig-name descname"><span class="pre">score_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianLL.score_dag" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Gaussian score or local Gaussian scores for each node given a DAG based on the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dag</strong> (<em>str</em>) – a model string DAG (e.g. <cite>[A][B][C][D|F:E:G][F][E|A:B][G|A:F:E][H|A:D:B]</cite>)</p></li>
<li><p><strong>by_node</strong> (<em>bool</em>) – if it is false (default), this returns the Gaussian score of the given DAG.
If it is true, this returns the local Gaussian scores for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Gaussian score of the given DAG, or the local Gaussian scores for each node.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-gaussianbic-class">
<h2>The GaussianBIC class<a class="headerlink" href="#the-gaussianbic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianBIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">GaussianBIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianBIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsGaussianLLScore" title="pygobnilp.scoring.AbsGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianBIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianBIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>GaussianBIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard BIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianBIC.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianBIC.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted Gaussian BIC score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Gaussian BIC local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-gaussianaic-class">
<h2>The GaussianAIC class<a class="headerlink" href="#the-gaussianaic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianAIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">GaussianAIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianAIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsGaussianLLScore" title="pygobnilp.scoring.AbsGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianAIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianAIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>GaussianAIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard AIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianAIC.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianAIC.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted Gaussian AIC score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Gaussian AIC local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-gaussianl0-class">
<h2>The GaussianL0 class<a class="headerlink" href="#the-gaussianl0-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianL0">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">GaussianL0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianL0" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsGaussianLLScore" title="pygobnilp.scoring.AbsGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsGaussianLLScore</span></code></a></p>
<p>Implements score discussed in “l_0-Penalized Maximum Likelihood for Sparse Directed
Acyclic Graphs” by Sara van de Geer and Peter Buehlmann. Annals of Statistics 41(2):536-567, 2013.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianL0.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianL0.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>GaussianL0</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Tuning parameter for L0 penalty. Called “lambda^2” in van de Geer and Buehlmann</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.GaussianL0.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.GaussianL0.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted Gaussian AIC score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Gaussian AIC local score for the given family and an upper bound on the local score
for proper supersets of <cite>parents</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-bge-class">
<h2>The BGe class<a class="headerlink" href="#the-bge-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.BGe">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">BGe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BGe" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.ContinuousData</span></code></a></p>
<p>Continuous data with attributes and methods for BGe scoring</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BGe.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BGe.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a BGe scoring object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – The data</p></li>
<li><p><strong>nu</strong> (<em>numpy.ndarray/None</em>) – the mean vector for the normal part of the
normal-Wishart prior. If not given (=None), then the sample mean
is used.</p></li>
<li><p><strong>alpha_mu</strong> (<em>float</em>) – imaginary sample size for the normal part of the
normal-Wishart prior.</p></li>
<li><p><strong>alpha_omega</strong> (<em>int/None</em>) – The degrees of freedom for the Wishart
part of the normal-Wishart prior. Must exceed p-1 where p is the number of
variables. If not given (=None) then <cite>alpha_omega</cite> is set to p+2.</p></li>
<li><p><strong>prior_matrix</strong> (<em>numpy.ndarray/None</em>) – The prior matrix ‘T’
for the Wishart part of the normal-Wishart prior. If not given (=None), then
this is set to t*I_n where t = alpha_mu*(alpha_omega-n-1)/(alpha_mu+1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BGe.bge_component">
<span class="sig-name descname"><span class="pre">bge_component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BGe.bge_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the BGe component for given variables</p>
<p>The BGe score for a family child&lt;-parents is the component for child+parents
minus the component for parents (+ a constant term which just depends on the number
of parents).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vs</strong> (<em>iter</em>) – Variable names</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The BGe component for the given variables</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.BGe.bge_score">
<span class="sig-name descname"><span class="pre">bge_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.BGe.bge_score" title="Permalink to this definition">¶</a></dt>
<dd><p>The BGe score for a given family, plus upper bound</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parents</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>First element of tuple isf the BGe score for the family for current data (using current hyperparameters)</dt><dd><p>Second element is an upper bound.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-mixeddata-class">
<h2>The MixedData class<a class="headerlink" href="#the-mixeddata-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">MixedData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.Data" title="pygobnilp.scoring.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.Data</span></code></a></p>
<p>Complete mixed data</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes a MixedData object.</p>
<p>If <cite>data_source</cite> is a filename then it is assumed that:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All values are separated by whitespace</p></li>
<li><p>Comment lines start with a ‘#’</p></li>
<li><p>The first line is a header line stating the names of the
variables</p></li>
<li><p>The second line states the arities of the variables</p></li>
<li><p>All other lines contain the actual data</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_source</strong> (<em>str/array_like/Pandas.DataFrame</em>) – Either a filename containing the data or a tuple of two numpy.ndarrays or
Pandas data frame containing it.</p></li>
<li><p><strong>varnames</strong> (<em>iter</em>) – Variable names corresponding to columns in the data.
Ignored if <cite>data_source</cite> is a filename or Pandas DataFrame (since they
will supply the variable names). Otherwise if not supplied (<cite>=None</cite>)
then discrete variable names will be: D1, D2, …, and
continuous variable names will be: C1, C2, …</p></li>
<li><p><strong>arities</strong> (<em>iter</em>) – Arities for the variables corresponding to columns in the data.
Ignored if <cite>data_source</cite> is a filename or Pandas DataFrame (since they
will supply the arities). Otherwise if not supplied (<cite>=None</cite>)
the arity for each variable will be set to the number of distinct values
observed for that variable in the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.arities">
<span class="sig-name descname"><span class="pre">arities</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.arities" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The arities of the discrete variables.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.arity">
<span class="sig-name descname"><span class="pre">arity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.arity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<em>str</em>) – A variable name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The arity of v</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The data with all values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The dataframe</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.data_length">
<span class="sig-name descname"><span class="pre">data_length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.data_length" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of datapoints in the data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.rawdata">
<span class="sig-name descname"><span class="pre">rawdata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.rawdata" title="Permalink to this definition">¶</a></dt>
<dd><p>The data without any information about variable names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The discrete data, the continuous data</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.MixedData.variables">
<span class="sig-name descname"><span class="pre">variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.MixedData.variables" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The variable names</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-abscgaussianllscore-class">
<h2>The AbsCGaussianLLScore class<a class="headerlink" href="#the-abscgaussianllscore-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">AbsCGaussianLLScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.MixedData" title="pygobnilp.scoring.MixedData"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.MixedData</span></code></a></p>
<p>Abstract class for mixed log likelihood scores</p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore.c_gaussianll">
<span class="sig-name descname"><span class="pre">c_gaussianll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore.c_gaussianll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the conditional Gaussian log-likelihood of some variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>iter</em>) – The variable set</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: The conditional Gaussian log-likelihood of some variables</p></li>
<li><p>int: The degrees of freedom</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore.con_gaussianll">
<span class="sig-name descname"><span class="pre">con_gaussianll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore.con_gaussianll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log-likelihood from whole data
It is used when all the family members are continuous variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>iter</em>) – indices of continuous variables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: the log-likelihood</p></li>
<li><p>int: the degrees of freedom</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore.dis_gaussianll">
<span class="sig-name descname"><span class="pre">dis_gaussianll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore.dis_gaussianll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log-likelihood from whole data
It is used when all the family members are discrete variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>iter</em>) – indices of discrete variables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: the log-likelihood</p></li>
<li><p>int: the degrees of freedom</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore.ll_score">
<span class="sig-name descname"><span class="pre">ll_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore.ll_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the conditional Gaussian log-likelihood score for a given family, plus the degrees of freedom</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent set</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: the conditional Gaussian log-likelihood score for the family for current data, and</p></li>
<li><p>int: the degrees of freedom</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.AbsCGaussianLLScore.mix_gaussianll">
<span class="sig-name descname"><span class="pre">mix_gaussianll</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cindices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rindices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.AbsCGaussianLLScore.mix_gaussianll" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log-likelihood from the data partitioned by discrete variables
It is used when the family members include both discrete and continuous variables</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cindices</strong> (<em>iter</em>) – Indices of continuous variables</p></li>
<li><p><strong>rindices</strong> (<em>iter</em>) – Indices of records in data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: the log-likelihood given the partitioned data</p></li>
<li><p>int: the degrees of freedom</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-cgaussianll-class">
<h2>The CGaussianLL class<a class="headerlink" href="#the-cgaussianll-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianLL">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">CGaussianLL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianLL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsCGaussianLLScore" title="pygobnilp.scoring.AbsCGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsCGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianLL.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianLL.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <cite>CGaussianLL</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.MixedData" title="pygobnilp.scoring.MixedData"><em>MixedData</em></a>) – data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianLL.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianLL.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted log-likelihood score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: The fitted log-likelihood local score for the given family</p></li>
<li><p>float: an upper bound on the local score for proper supersets of <cite>parents</cite></p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianLL.score_dag">
<span class="sig-name descname"><span class="pre">score_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianLL.score_dag" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the CG score or local CG scores for each node given a DAG based on the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dag</strong> (<em>str</em>) – a model string DAG (e.g. <cite>[A][B][C][D|F:E:G][F][E|A:B][G|A:F:E][H|A:D:B]</cite>)</p></li>
<li><p><strong>by_node</strong> (<em>bool</em>) – if it is false (default), this returns the CG score of the given DAG.
If it is true, this returns the local CG scores for each node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The CG score of the given DAG, or the local CG scores for each node.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-cgaussianbic-class">
<h2>The CGaussianBIC class<a class="headerlink" href="#the-cgaussianbic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianBIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">CGaussianBIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianBIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsCGaussianLLScore" title="pygobnilp.scoring.AbsCGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsCGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianBIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianBIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>CGaussianBIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.MixedData" title="pygobnilp.scoring.MixedData"><em>MixedData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard BIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianBIC.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianBIC.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted conditional Gaussian BIC score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: The conditional Gaussian BIC local score for the given family and</p></li>
<li><p>float: an upper bound on the local score for proper supersets of <cite>parents</cite></p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-cgaussianaic-class">
<h2>The CGaussianAIC class<a class="headerlink" href="#the-cgaussianaic-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianAIC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pygobnilp.scoring.</span></span><span class="sig-name descname"><span class="pre">CGaussianAIC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianAIC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pygobnilp.scoring.AbsCGaussianLLScore" title="pygobnilp.scoring.AbsCGaussianLLScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">pygobnilp.scoring.AbsCGaussianLLScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianAIC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianAIC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises an <cite>GaussianAIC</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pygobnilp.scoring.ContinuousData" title="pygobnilp.scoring.ContinuousData"><em>ContinuousData</em></a>) – data</p></li>
<li><p><strong>k</strong> (<em>float</em>) – Multiply standard AIC penalty by this amount, so increase for sparser networks</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pygobnilp.scoring.CGaussianAIC.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">child</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.scoring.CGaussianAIC.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fitted Gaussian AIC score for <cite>child</cite> having <cite>parents</cite>,
and also upper bound on the score for proper supersets of <cite>parents</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>child</strong> (<em>str</em>) – The child variable</p></li>
<li><p><strong>parents</strong> (<em>iter</em>) – The parent variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>float: The Gaussian AIC local score for the given family and</p></li>
<li><p>float: an upper bound on the local score for proper supersets of <cite>parents</cite></p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pygobnilp.gobnilp">
<span id="functions-in-the-gobnilp-module"></span><h2>Functions in the gobnilp module<a class="headerlink" href="#module-pygobnilp.gobnilp" title="Permalink to this headline">¶</a></h2>
<p>Python version of GOBNILP</p>
<dl class="py function">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.from_bnlearn_modelstring">
<span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">from_bnlearn_modelstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelstring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.from_bnlearn_modelstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a DAG from a bnlearn modelstring</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>modelstring</strong> (<em>str</em>) – A bnlearn modelstring defining a DAG</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The DAG as a networkx Digraph</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>networkx.DiGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.mhs">
<span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">mhs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.mhs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a minimal hitting set for a set of subsets</p>
<p>A hitting set is a set of elements from the ground set that has non empty intersection
with each of the given subsets. A minimal hitting set is a hitting set with minimal cardinality.
This function uses Gurobi to solve this NP-hard problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subsets</strong> (<em>iter</em>) – The collection of subsets for which the minimal hitting set is sought.
These could be, for example, a list of lists of strings where the strings are elements
of the <cite>ground_set</cite>.</p></li>
<li><p><strong>ground_set</strong> (<em>iter</em>) – The ground set: each subset must be a subset of this ground set. If missing
(=None) then the ground set is the union of all the given subsets.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If Gurobi cannot solve the minimal hitting set problem.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A minimal hitting set which will be a subset of the ground set, or None
if there is no hitting set.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list/None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pygobnilp.gobnilp.read_local_scores">
<span class="sig-prename descclassname"><span class="pre">pygobnilp.gobnilp.</span></span><span class="sig-name descname"><span class="pre">read_local_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pygobnilp.gobnilp.read_local_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Read local scores from a named file, standard input or a file object,
and return a dictionary dkt where dkt[child][parentset] is the local score
for the family child&lt;-parentset</p>
<p>The file is assumed to be in “Jaakkola” format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>str/file object</em>) – The file containing the local scores.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing local scores</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, James Cussens.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>